<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sistema de Educação — 7º/8º Ano + Jogo Matemático</title>
  <meta name="description" content="Conteúdos interativos para 7º e 8º ano com um jogo educativo de operações básicas." />
  <style>
    :root{--bg:#f4f7fb;--card:#fff;--brand1:#2563eb;--brand2:#9333ea;--accent:#10b981;--muted:#6b7280}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,Segoe UI,Arial,sans-serif;background:var(--bg);color:#111}
    header{background:linear-gradient(135deg,var(--brand1),var(--brand2));color:#fff;padding:28px 20px;text-align:center}
    header h1{margin:0;font-size:30px}
    header p{margin:6px 0 0;opacity:.95}
    nav{display:flex;justify-content:center;gap:6px;flex-wrap:wrap;padding:12px;background:#fff}
    nav button{border:0;background:#f3f4f6;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:600}
    nav button.active{background:linear-gradient(90deg,var(--brand1),var(--brand2));color:#fff}
    .wrap{max-width:1200px;margin:28px auto;padding:0 18px}
    .grid{display:grid;grid-template-columns:1fr 420px;gap:20px}
    @media(max-width:980px){.grid{grid-template-columns:1fr}}
    .card{background:var(--card);border-radius:14px;padding:18px;box-shadow:0 8px 24px rgba(15,23,42,.06)}
    .subjects{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:14px}
    .subject{border-radius:12px;padding:12px;background:linear-gradient(180deg,rgba(99,102,241,.06),transparent);cursor:pointer}
    .subject h3{margin:0;color:var(--brand1)}

    /* Game area */
    .game-surface{display:flex;flex-direction:column;gap:12px}
    .panel-row{display:flex;gap:12px;align-items:center}
    .score-box{background:#fff;padding:12px;border-radius:10px;box-shadow:0 6px 14px rgba(2,6,23,.04);flex:1}
    .large{font-size:22px;font-weight:800;color:var(--brand2)}
    .controls{display:flex;gap:8px;flex-wrap:wrap}
    .btn{background:linear-gradient(90deg,var(--brand1),var(--brand2));color:#fff;border:0;padding:10px 14px;border-radius:10px;font-weight:700;cursor:pointer}
    .btn.ghost{background:transparent;color:var(--brand1);border:2px solid rgba(37,99,235,.12)}

    .question-box{background:linear-gradient(180deg,#fff,rgba(243,244,246,.9));padding:18px;border-radius:12px;text-align:center}
    .question{font-size:20px;font-weight:800;margin:6px 0}
    .choices{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:12px}
    .choice{padding:12px;border-radius:10px;background:#fafafa;border:2px solid transparent;cursor:pointer;font-weight:700}
    .choice.correct{background:#ecfdf5;border-color:#10b981}
    .choice.wrong{background:#fff1f2;border-color:#fb7185}
    .meta{color:var(--muted);font-size:13px}

    /* Topic page */
    .topic-page{display:none}
    .topic-header{display:flex;align-items:center;gap:12px}
    .back{background:transparent;border:0;color:var(--brand1);cursor:pointer;font-weight:800}

    footer{margin-top:30px;text-align:center;padding:18px;color:var(--muted);font-size:14px}
  </style>
</head>
<body>
  <header>
    <h1>Sistema de Educação — 7º/8º Ano</h1>
    <p>Revisões, explicações e um jogo para praticar operações básicas (adição, subtração, multiplicação e divisão).</p>
  </header>

  <nav>
    <button id="btnHome" class="active" onclick="showView('home')">Início</button>
    <button onclick="showView('game')">Jogo Matemático</button>
    <button onclick="showView('material')">Materiais</button>
    <button onclick="showView('ranking')">Ranking</button>
  </nav>

  <main class="wrap">
    <!-- HOME / SUBJECTS -->
    <section id="home" class="card">
      <h2 style="margin-top:0">Conteúdos do Curso</h2>
      <p class="meta">Clique em um assunto para ver o resumo ou para praticar no jogo.</p>
      <div class="subjects" style="margin-top:12px">
        <div class="subject" onclick="openTopic('adjunto')"><h3>Adjunto Adverbial (PT)</h3><div class="meta">Gramática — 7º</div></div>
        <div class="subject" onclick="openTopic('aposto')"><h3>Aposto (PT)</h3><div class="meta">Gramática — 7º</div></div>
        <div class="subject" onclick="openTopic('simplepast')"><h3>Simple Past (EN)</h3><div class="meta">Inglês — 7º</div></div>
        <div class="subject" onclick="openTopic('preterito')"><h3>Pretérito Imperfecto (ES)</h3><div class="meta">Espanhol — 8º</div></div>
        <div class="subject" onclick="openTopic('equacoes')"><h3>Equações 1ª Grau (MAT)</h3><div class="meta">Matemática — 7º/8º</div></div>
        <div class="subject" onclick="openTopic('porcentagem')"><h3>Porcentagem (MAT)</h3><div class="meta">Matemática — 7º</div></div>
      </div>
    </section>

    <!-- GAME -->
    <section id="game" class="card" style="display:none">
      <div class="game-surface">
        <div class="panel-row">
          <div class="score-box">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div>
                <div class="large" id="score">Pontos: 0</div>
                <div class="meta" id="streak">Sequência: 0 | Vidas: 3</div>
              </div>
              <div style="text-align:right">
                <div class="meta">Tempo: <span id="timer">--</span></div>
                <div class="meta">Nível: <strong id="levelLabel">Fácil</strong></div>
              </div>
            </div>
          </div>
          <div class="controls">
            <select id="gradeSel"><option value="7">7º Ano</option><option value="8">8º Ano</option></select>
            <select id="difficulty"><option value="easy">Fácil</option><option value="medium">Médio</option><option value="hard">Difícil</option></select>
            <button class="btn" id="startBtn">▶ Iniciar</button>
            <button class="btn ghost" id="practiceBtn">Praticar</button>
          </div>
        </div>

        <div class="question-box" id="questionBox" style="display:none">
          <div class="meta" id="qMeta">Operação: + | Nível: Fácil</div>
          <div class="question" id="questionText">Quanto é 2 + 2 ?</div>
          <div class="choices" id="choices"></div>
        </div>

        <div id="gameOver" style="display:none;text-align:center">
          <h3>Fim de jogo</h3>
          <p id="endMsg"></p>
          <button class="btn" onclick="restartGame()">Jogar novamente</button>
        </div>

      </div>
    </section>

    <!-- MATERIAL (topic pages) -->
    <section id="material" class="card" style="display:none">
      <div id="topicPage" class="topic-page">
        <button class="back" onclick="closeTopic()">← Voltar</button>
        <h2 id="topicTitle">Título</h2>
        <div id="topicBody"></div>
      </div>
    </section>

    <!-- RANKING -->
    <aside id="ranking" class="card" style="display:none">
      <h2>Ranking local</h2>
      <p class="meta">Pontuações salvas no seu navegador.</p>
      <ol id="rankingList"></ol>
    </aside>

  </main>

  <footer>Feito para estudar — pratique, erre e aprenda!</footer>

  <script>
    // ===== Navegação de views
    const views = ['home','game','material','ranking'];
    function showView(id){
      views.forEach(v=> document.getElementById(v).style.display = (v===id? (v==='home'?'block':'block') : 'none'));
      document.querySelectorAll('nav button').forEach(b=> b.classList.remove('active'));
      document.querySelectorAll('nav button').forEach(b=>{ if(b.textContent.trim().startsWith(id.charAt(0).toUpperCase())){} });
      // toggle active by index
      const btnIndex = {home:0,game:1,material:2,ranking:3}[id];
      document.querySelectorAll('nav button')[btnIndex].classList.add('active');
      if(id==='ranking') renderRanking();
    }

    // ===== Topics content
    const topics = {
      adjunto: {title:'Adjunto Adverbial',body:`<p>É o termo que acrescenta uma circunstância ao verbo: tempo, lugar, modo, causa, etc.</p><p><strong>Ex:</strong> Ontem, eu estudei. (adjunto adverbial de tempo)</p>`},
      aposto: {title:'Aposto',body:`<p>É um termo que explica ou especifica outro termo na oração. Geralmente vem entre vírgulas ou após dois-pontos.</p><p><strong>Ex:</strong> João, <em>meu amigo</em>, chegou cedo.</p>`},
      simplepast: {title:'Simple Past (Inglês)',body:`<p>Usado para ações concluídas no passado. Formado por verbos regulares (-ed) e irregulares (went, saw).</p>`},
      preterito: {title:'Pretérito Imperfecto (Espanhol)',body:`<p>Expressa hábitos e descrições no passado: yo hablaba, tú comías.</p>`},
      equacoes: {title:'Equações do 1º Grau',body:`<p>Equações com incógnita de grau 1. Exemplo: 2x+3=7 → x=2.</p>`},
      porcentagem: {title:'Porcentagem',body:`<p>É uma razão com denominador 100. Para calcular: parte = total * (porcentagem/100).</p>`}
    };

    function openTopic(key){
      document.getElementById('topicTitle').innerHTML = topics[key].title;
      document.getElementById('topicBody').innerHTML = topics[key].body + `<p style="margin-top:12px"><button class='btn' onclick="startFromTopic('${key}')">Praticar este assunto no jogo</button></p>`;
      showView('material');
      document.getElementById('topicPage').style.display = 'block';
    }
    function closeTopic(){ document.getElementById('topicPage').style.display='none'; showView('home'); }

    function startFromTopic(key){
      // map topic to operation/difficulty
      const map = {adjunto:null, aposto:null, simplepast:null, preterito:null, equacoes:'mixed', porcentagem:'mixed'};
      // For math topics, open game and set practice mode
      if(map[key]){
        prepareGame({mode:'practice',operation:map[key]});
        showView('game');
      } else {
        alert('Este tópico não é um exercício matemático. Escolha um assunto de matemática para praticar.');
      }
    }

    // ===== Game logic =====
    const startBtn = document.getElementById('startBtn');
    const practiceBtn = document.getElementById('practiceBtn');
    const questionBox = document.getElementById('questionBox');
    const questionText = document.getElementById('questionText');
    const choicesEl = document.getElementById('choices');
    const scoreEl = document.getElementById('score');
    const streakEl = document.getElementById('streak');
    const timerEl = document.getElementById('timer');
    const levelLabel = document.getElementById('levelLabel');
    const gradeSel = document.getElementById('gradeSel');
    const difficultySel = document.getElementById('difficulty');

    let gameState = {running:false,score:0,streak:0,lives:3,time:20,operation:'mixed',difficulty:'easy',grade:7,timerId:null,question:null,practice:false};

    startBtn.addEventListener('click', ()=> prepareGame({mode:'game'}));
    practiceBtn.addEventListener('click', ()=> prepareGame({mode:'practice'}));

    function prepareGame(opts){
      const mode = opts.mode || 'game';
      gameState.practice = mode==='practice';
      gameState.difficulty = difficultySel.value;
      gameState.grade = parseInt(gradeSel.value,10);
      gameState.operation = opts.operation || 'mixed';
      gameState.score=0;gameState.streak=0;gameState.lives=3;
      updateUI();
      startRound();
      showView('game');
    }

    function updateUI(){ scoreEl.innerText = `Pontos: ${gameState.score}`; streakEl.innerText = `Sequência: ${gameState.streak} | Vidas: ${gameState.lives}`; levelLabel.innerText = gameState.difficulty==='easy'?'Fácil':gameState.difficulty==='medium'?'Médio':'Difícil'; }

    function startRound(){
      questionBox.style.display='block'; document.getElementById('gameOver').style.display='none';
      gameState.question = generateQuestion();
      renderQuestion(gameState.question);
      startTimer();
    }

    function generateQuestion(){
      // choose operation based on difficulty and mode
      const ops = ['+','-','*','/'];
      let op = (gameState.operation && gameState.operation!=='mixed')?gameState.operation: ops[Math.floor(Math.random()*ops.length)];
      const diff = gameState.difficulty;
      // number ranges
      let min=1,max=10;
      if(diff==='easy'){min=1;max=10}
      if(diff==='medium'){min=2;max=20}
      if(diff==='hard'){min=5;max=50}
      const a = randInt(min,max); let b = randInt(min,max);
      // for division, ensure divisible
      if(op==='/' ){ b = randInt(2,Math.max(2,Math.floor(max/2))); const prod = a * b; return {q:`${prod} ÷ ${b}`, ans: a, op:'/'} }
      // randomize to avoid negative subtraction in easy
      if(op==='-' && a<b) return {q:`${b} - ${a}`, ans: b-a, op:'-'}
      let expr = `${a} ${op} ${b}`; let ans = evalSimple(a,op,b);
      return {q:expr, ans:ans, op:op};
    }
    function evalSimple(a,op,b){ if(op==='+')return a+b; if(op==='-')return a-b; if(op==='*')return a*b; if(op==='/')return Math.round((a/b)*100)/100; }

    function renderQuestion(q){ document.getElementById('qMeta').innerText = `Operação: ${q.op} | Nível: ${gameState.difficulty}`; questionText.innerText = `Quanto é ${q.q} ?`; choicesEl.innerHTML='';
      const correct = q.ans; const options = generateChoices(correct);
      options.forEach(opt=>{
        const b = document.createElement('button'); b.className='choice'; b.innerText = opt; b.onclick = ()=> chooseAnswer(opt,b,correct);
        choicesEl.appendChild(b);
      });
    }

    function generateChoices(correct){
      const choices = new Set(); choices.add(correct);
      const spread = gameState.difficulty==='easy'?5: gameState.difficulty==='medium'?12:30;
      while(choices.size<4){ let v = correct + randInt(-Math.max(1,Math.floor(spread/4)), Math.max(1,Math.floor(spread/2))); if(typeof correct==='number'){ if(Math.abs(v-correct)<1) v = correct + randInt(1,Math.max(2,Math.floor(spread/3))); }
        choices.add(v);
      }
      const arr = Array.from(choices).sort(()=>Math.random()-0.5);
      return arr;
    }

    function chooseAnswer(value,buttonEl,correct){ stopTimer();
      const numericValue = Number(value);
      if(numericValue === Number(correct)){
        buttonEl.classList.add('correct'); gameState.score += 10; gameState.streak +=1;
      } else { buttonEl.classList.add('wrong'); gameState.lives -=1; gameState.streak = 0; }
      updateUI();
      setTimeout(()=>{
        if(gameState.lives<=0 && !gameState.practice){ endGame(); return; }
        startRound();
      },800);
    }

    function startTimer(){ clearInterval(gameState.timerId); let t = gameState.practice?30: (gameState.difficulty==='easy'?20: gameState.difficulty==='medium'?15:10); timerEl.innerText = `${t}s`; gameState.timerId = setInterval(()=>{ t--; timerEl.innerText = `${t}s`; if(t<=0){ clearInterval(gameState.timerId); gameState.lives -=1; gameState.streak=0; updateUI(); if(gameState.lives<=0 && !gameState.practice){ endGame(); } else { startRound(); } } },1000); }
    function stopTimer(){ clearInterval(gameState.timerId); }

    function endGame(){ stopTimer(); questionBox.style.display='none'; document.getElementById('gameOver').style.display='block'; document.getElementById('endMsg').innerText = `Você fez ${gameState.score} pontos.`; saveScore(gameState.score); }
    function restartGame(){ prepareGame({mode:'game'}); }

    function randInt(min,max){ return Math.floor(Math.random()*(max-min+1))+min }

    // ===== Ranking local =====
    function saveScore(points){ const name = prompt('Digite um nome para salvar sua pontuação (ou cancele):'); if(!name) return; const data = JSON.parse(localStorage.getItem('edu_ranking')||'[]'); data.push({name:name,points:points,date:new Date().toISOString()}); data.sort((a,b)=>b.points-a.points); localStorage.setItem('edu_ranking', JSON.stringify(data.slice(0,10))); renderRanking(); }
    function renderRanking(){ const list = JSON.parse(localStorage.getItem('edu_ranking')||'[]'); const ol = document.getElementById('rankingList'); ol.innerHTML=''; list.forEach(it=>{ const li = document.createElement('li'); li.innerText = `${it.name} — ${it.points} pts (${new Date(it.date).toLocaleDateString()})`; ol.appendChild(li); }); if(list.length===0) ol.innerHTML='<li style="color:var(--muted)">Nenhuma pontuação salva ainda.</li>' }

    // ===== small helpers =====
    // Ensure home visible initially
    showView('home');
  </script>
</body>
</html>
